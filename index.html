<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>房貸試算工具</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 30px; max-width: 600px; margin: auto; }
    label, select, input, button { display: block; margin: 10px 0; width: 100%; }
    #result { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>房貸試算工具</h2>

  <label>貸款金額（萬元）</label> <!-- 🔴 調整：顯示單位為萬元 -->
  <input type="number" id="loanAmount" placeholder="請輸入貸款金額">

  <label>貸款年限</label>
  <input type="number" id="loanYears" placeholder="請輸入年數（例如 20）">

  <label>選擇銀行（自動帶入利率）</label>
  <select id="bankSelect" onchange="setRate()">
    <option value="">-- 請選擇 --</option>
    <option value="1.68">台灣銀行（1.68%）</option>
    <option value="1.75">土地銀行（1.75%）</option>
    <option value="1.82">合作金庫（1.82%）</option>
    <option value="1.90">第一銀行（1.90%）</option>
    <option value="1.95">華南銀行（1.95%）</option>
    <option value="2.05">台新銀行（2.05%）</option>
    <option value="2.10">中國信託（2.10%）</option>
    <option value="2.15">玉山銀行（2.15%）</option>
    <option value="2.20">國泰世華（2.20%）</option>
    <option value="2.25">永豐銀行（2.25%）</option>
    <option value="1.85">農會（1.85%）</option>
  </select>

  <label>或自行輸入利率（%）</label>
  <input type="number" step="0.01" id="customRate" placeholder="例如：1.88">

  <label>還款方式</label>
  <select id="repaymentType">
    <option value="equal">本息平均（等額本息）</option>
    <option value="principal">本金平均（等額本金）</option>
  </select>

  <button onclick="calculate()">試算</button>

  <div id="result"></div>

  <script>
    function setRate() {
      const rate = document.getElementById('bankSelect').value;
      document.getElementById('customRate').value = rate;
    }

    function calculate() {
      // 🔴 調整：把萬元轉成元
      const loanAmount = parseFloat(document.getElementById('loanAmount').value) * 10000;
      const loanYears = parseInt(document.getElementById('loanYears').value);
      const interestRate = parseFloat(document.getElementById('customRate').value);
      const repaymentType = document.getElementById('repaymentType').value;

      if (!loanAmount || !loanYears || !interestRate) {
        alert("請輸入完整資訊！");
        return;
      }

      const monthlyRate = interestRate / 100 / 12;
      const totalMonths = loanYears * 12;
      let resultHTML = "";

      if (repaymentType === "equal") {
        const monthlyPayment = (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, totalMonths)) / 
                               (Math.pow(1 + monthlyRate, totalMonths) - 1);
        const totalPayment = monthlyPayment * totalMonths;
        const totalInterest = totalPayment - loanAmount;

        resultHTML += `<p>【等額本息】</p>`;
        resultHTML += `每月應繳金額：<span style="color:green;">${monthlyPayment.toFixed(0)} 元</span><br>`;
        resultHTML += `總還款金額：${totalPayment.toFixed(0)} 元<br>`;
        resultHTML += `總利息金額：${totalInterest.toFixed(0)} 元<br>`;

      } else {
        const monthlyPrincipal = loanAmount / totalMonths;
        let totalPayment = 0;
        let firstMonth = 0;

        for (let i = 0; i < totalMonths; i++) {
          const interest = (loanAmount - monthlyPrincipal * i) * monthlyRate;
          const monthly = monthlyPrincipal + interest;
          if (i === 0) firstMonth = monthly;
          totalPayment += monthly;
        }

        const totalInterest = totalPayment - loanAmount;

        resultHTML += `<p>【等額本金】</p>`;
        resultHTML += `首月應繳金額：<span style="color:green;">${firstMonth.toFixed(0)} 元</span><br>`;
        resultHTML += `總還款金額：${totalPayment.toFixed(0)} 元<br>`;
        resultHTML += `總利息金額：${totalInterest.toFixed(0)} 元<br>`;
      }

      document.getElementById('result').innerHTML = resultHTML;
    }
  </script>
</body>
</html>
